<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    canvas {
      border: 1px solid gray;
    }
  </style>
</head>

<body>
  <img style="display: none;" id="bg" src="/gui/resources/bg.png" />
  <canvas id="canvas" width="640" height="480">

  </canvas>
  <script>
    let canvas = document.getElementById("canvas");
    let bg = document.getElementById("bg");
    let context = canvas.getContext("2d");
    context.drawImage(bg, 0, 0);
    let draw = false;
    function getMousePos(evt) {
      let rect = canvas.getBoundingClientRect();
      return {
        x: evt.clientX - rect.left,
        y: evt.clientY - rect.top
      };
    }
    let mouseX = 0;
    let mouseY = 0;
    var track = [];
    function setMousePosition(e) {
      if (draw) {
        mouseX = getMousePos(e).x;
        mouseY = getMousePos(e).y;
        track.push([mouseX, mouseY])
      }
    }
    function update() {

      context.beginPath();
      context.arc(mouseX, mouseY, 2, 0, 2 * Math.PI, true);
      context.fillStyle = "#FF6A6A";
      context.fill();


      requestAnimationFrame(update);
    }
    update();

    canvas.addEventListener("mousedown", () => { draw = true }, false)
    canvas.addEventListener("mousemove", setMousePosition, false)
    canvas.addEventListener("mouseup", () => { draw = false }, false)

    const Direction = {
      Straight: "Straight",
      Backwards: "Backwards",
      Left: "Left",
      Right: "Right",
    }

    function GetDirection(a, b, c) {
      let theta1 = GetAngle(a, b);
      let theta2 = GetAngle(b, c);
      let delta = NormalizeAngle(theta2 - theta1);

      if (delta == 0)
        return Direction.Straight;
      else if (delta == Math.PI)
        return Direction.Backwards;
      else if (delta < Math.PI)
        return Direction.Left;
      else return Direction.Right;
    }

    function GetAngle(p1, p2) {
      let angleFromXAxis = Math.atan((p2.Y - p1.Y) / (p2.X - p1.X)); // where y = m * x + K
      return p2.X - p1.X < 0 ? angleFromXAxis + Math.PI : angleFromXAxis; // The will go to the correct Quadrant
    }

    function NormalizeAngle(angle) {
      return angle < 0 ? angle + 2 * Math.PI : angle; //This will make sure angle is [0..2PI]
    }
  </script>
</body>

</html>

<!-- https://www.kirupa.com/canvas/follow_mouse_cursor.htm -->
<!-- https://stackoverflow.com/questions/17130395/real-mouse-position-in-canvas -->
<!-- https://www.dcode.fr/binary-image -->
<!-- https://stackoverflow.com/questions/3419341/how-to-calculate-turning-direction/56278133#56278133 -->
